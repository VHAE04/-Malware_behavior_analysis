# Virut shortcut usb 

### SHA1 : 7ddb61872830f4a0e6bf96faf665337d01f164fc

![image](https://github.com/VHAE04/Malware_behavior_analysis/blob/main/Virut_usb_shorcut/virut_usb_shortcut.PNG?raw=true)


Ban đầu virut được tạo ra từ một phần mền độc hại đã được gắn định từ trước có thể coi là `Virus Trojan` khả năng được viết bằng `c++` và được `Obfuscator` 

Với vidu đưới đây virut đã được gán vào phần mền `Adobe Stock Photo CS3` với tiến trình `AdobePhotos.exe`

Tiến trình của virut như sau khi thực thi trên máy nạn nhân
-Sẽ kích hoạt chế độ autorun kèm tạo file `autorun.inf` trên usb để có thể tự thực thi ngay sau khi usb cắm vào pc (chỉ áp dụng trên win 7)
-Tự nhân bản file độc hại và gom file của nạn nhân vào thư mục ẩn
-Tạo một shortcut với icon usb và được link đến file virut

Tiến trình virut:
-Ngay sau khi thực thi shortcut được link với `%comspec% /q /c "Docusment\1\1.exe 113 58`

virut sẽ tự dump vào `C:\ProgramData\AdobePhotosFmB\AdobePhotos.exe"`
   + kèm thêm chỉnh sửa lại ngày biên dịch nhằm qua mặt antivirut và một số phần mền theo giõi thời gian thực thi của virut 
   
Thêm key khởi động ở regedit `HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN`

Viết đè thêm file `C:\Users\admin\Desktop\1\1\Adobe_Caps.dll`

File này có nhiệm vụ để post thông tin nạn nhân lên và giao tiếp với server thông qua `dllhost.exe`  với host trung quốc `http://101.36.125.203:965/[hash]` đã được mã hoá dữ liệu cùng với tên được encode bằng base64 exam file `a2UgaG9hY2ggaHXhuqVuIGx1eeG7h24gODAyMSB04bqhaSA4MDIwX0vhur4gSE_huqBDSCBIVeG6pE4gTFVZ4buGTiBLSFVORyBIQU1JTFRPTi5kb2M=`


## Cách khắc phục

- Tiến hành mở taskmanager xem tiến trình lạ và các tiến trình đang sử dụng mạng với một ip lạ lưu lại thông tin địa chỉ file cùng với tên file
- Mở cmd trên usb và gõ lệnh `attrib -h -r -s /s /d e:\*.*` nhằm hiện các file đã bị virut ẩn
- tiến hành sao lưu các file quan trọng trong usb và format usb
- kiểm tra và xoá các tiến trình thực thi lạ ở `C:\Users\MY-PC\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`và trong regedit `HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN`
- xoá các file đã được virut dump trong `C:\ProgramData\XXX`
